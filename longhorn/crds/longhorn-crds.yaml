# longhorn/longhorn-crds.yaml
# Custom Resource Definitions for Longhorn
# Based on Longhorn v1.6.x

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: engines.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: Engine
    listKind: EngineList
    plural: engines
    shortNames:
    - lhe
    singular: engine
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              volumeName:
                type: string
              volumeSize:
                type: string
              replicaAddressMap:
                type: object
                additionalProperties:
                  type: string
              frontend:
                type: string
              engineImage:
                type: string
              requestedBackupRestore:
                type: string
              disableFrontend:
                type: boolean
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: replicas.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: Replica
    listKind: ReplicaList
    plural: replicas
    shortNames:
    - lhr
    singular: replica
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              volumeName:
                type: string
              volumeSize:
                type: string
              nodeID:
                type: string
              diskID:
                type: string
              diskPath:
                type: string
              dataDirectoryName:
                type: string
              engineImage:
                type: string
              active:
                type: boolean
              hardNodeAffinity:
                type: string
              revisionCounterDisabled:
                type: boolean
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: volumes.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: Volume
    listKind: VolumeList
    plural: volumes
    shortNames:
    - lhv
    singular: volume
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              size:
                type: string
              frontend:
                type: string
              fromBackup:
                type: string
              dataSource:
                type: string
              numberOfReplicas:
                type: integer
              replicaAutoBalance:
                type: string
              dataLocality:
                type: string
              staleReplicaTimeout:
                type: integer
              nodeID:
                type: string
              engineImage:
                type: string
              recurringJobSelector:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                    isGroup:
                      type: boolean
              diskSelector:
                type: array
                items:
                  type: string
              nodeSelector:
                type: array
                items:
                  type: string
              revisionCounterDisabled:
                type: boolean
              unmapMarkSnapChainRemoved:
                type: string
              snapshotMaxCount:
                type: integer
              snapshotMaxSize:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: State
      type: string
      description: The state of the volume
      jsonPath: .status.state
    - name: Robustness
      type: string
      description: The robustness of the volume
      jsonPath: .status.robustness
    - name: Scheduled
      type: string
      description: The scheduled condition of the volume
      jsonPath: .status.conditions['Scheduled']['status']
    - name: Size
      type: string
      description: The size of the volume
      jsonPath: .spec.size
    - name: Node
      type: string
      description: The node that the volume is currently attaching to
      jsonPath: .spec.nodeID
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: engineimages.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: EngineImage
    listKind: EngineImageList
    plural: engineimages
    shortNames:
    - lhei
    singular: engineimage
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              image:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: State
      type: string
      description: State of the engine image
      jsonPath: .status.state
    - name: Image
      type: string
      description: The Longhorn engine image
      jsonPath: .spec.image
    - name: RefCount
      type: integer
      description: Number of volumes are using the engine image
      jsonPath: .status.refCount
    - name: BuildDate
      type: date
      description: The build date of the engine image
      jsonPath: .status.buildDate
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nodes.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: Node
    listKind: NodeList
    plural: nodes
    shortNames:
    - lhn
    singular: node
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              name:
                type: string
              disks:
                type: object
                additionalProperties:
                  type: object
                  properties:
                    path:
                      type: string
                    allowScheduling:
                      type: boolean
                    evictionRequested:
                      type: boolean
                    storageReserved:
                      type: integer
                    tags:
                      type: array
                      items:
                        type: string
              allowScheduling:
                type: boolean
              evictionRequested:
                type: boolean
              tags:
                type: array
                items:
                  type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: Ready
      type: string
      description: Indicate whether the node is ready
      jsonPath: .status.conditions['Ready']['status']
    - name: AllowScheduling
      type: boolean
      description: Indicate whether the user disabled scheduling for the node
      jsonPath: .spec.allowScheduling
    - name: Schedulable
      type: string
      description: Indicate whether Longhorn can schedule replicas on the node
      jsonPath: .status.conditions['Schedulable']['status']
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: instancemanagers.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: InstanceManager
    listKind: InstanceManagerList
    plural: instancemanagers
    shortNames:
    - lhim
    singular: instancemanager
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              image:
                type: string
              nodeID:
                type: string
              type:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: State
      type: string
      description: The state of the instance manager
      jsonPath: .status.currentState
    - name: Type
      type: string
      description: The type of the instance manager (engine or replica)
      jsonPath: .spec.type
    - name: Node
      type: string
      description: The node that the instance manager is running on
      jsonPath: .spec.nodeID
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: sharemanagers.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: ShareManager
    listKind: ShareManagerList
    plural: sharemanagers
    shortNames:
    - lhsm
    singular: sharemanager
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              image:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: backingimages.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: BackingImage
    listKind: BackingImageList
    plural: backingimages
    shortNames:
    - lhbi
    singular: backingimage
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              sourceType:
                type: string
              sourceParameters:
                type: object
                additionalProperties:
                  type: string
              checksum:
                type: string
              disks:
                type: object
                additionalProperties:
                  type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: Size
      type: string
      description: The backing image size
      jsonPath: .status.size
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: backingimagemanagers.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: BackingImageManager
    listKind: BackingImageManagerList
    plural: backingimagemanagers
    shortNames:
    - lhbim
    singular: backingimagemanager
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              image:
                type: string
              nodeID:
                type: string
              diskUUID:
                type: string
              diskPath:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: backingimgedatasources.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: BackingImageDataSource
    listKind: BackingImageDataSourceList
    plural: backingimgedatasources
    shortNames:
    - lhbids
    singular: backingimgedatasource
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              sourceType:
                type: string
              parameters:
                type: object
                additionalProperties:
                  type: string
              fileTransferred:
                type: boolean
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: backuptargets.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: BackupTarget
    listKind: BackupTargetList
    plural: backuptargets
    shortNames:
    - lhbt
    singular: backuptarget
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              backupTargetURL:
                type: string
              credentialSecret:
                type: string
              pollInterval:
                type: string
              syncRequestedAt:
                type: string
                format: date-time
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: URL
      type: string
      description: The backup target URL
      jsonPath: .spec.backupTargetURL
    - name: Credential
      type: string
      description: The backup target credential secret
      jsonPath: .spec.credentialSecret
    - name: LastBackupAt
      type: string
      description: The backup target last backup time
      jsonPath: .status.lastBackupAt
    - name: Available
      type: boolean
      description: Indicate whether the backup target is available or not
      jsonPath: .status.available
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: backupvolumes.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: BackupVolume
    listKind: BackupVolumeList
    plural: backupvolumes
    shortNames:
    - lhbv
    singular: backupvolume
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              syncRequestedAt:
                type: string
                format: date-time
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: CreatedAt
      type: string
      description: The backup volume creation time
      jsonPath: .status.createdAt
    - name: LastBackupName
      type: string
      description: The backup volume last backup name
      jsonPath: .status.lastBackupName
    - name: LastBackupAt
      type: string
      description: The backup volume last backup time
      jsonPath: .status.lastBackupAt
    - name: LastSyncedAt
      type: string
      description: The backup volume last synced time
      jsonPath: .status.lastSyncedAt

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: backups.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: Backup
    listKind: BackupList
    plural: backups
    shortNames:
    - lhb
    singular: backup
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              snapshotName:
                type: string
              labels:
                type: object
                additionalProperties:
                  type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: SnapshotName
      type: string
      description: The snapshot name
      jsonPath: .spec.snapshotName
    - name: SnapshotCreatedAt
      type: string
      description: The snapshot creation time
      jsonPath: .status.snapshotCreatedAt
    - name: State
      type: string
      description: The backup state
      jsonPath: .status.state
    - name: LastSyncedAt
      type: string
      description: The backup last synced time
      jsonPath: .status.lastSyncedAt

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: recurringjobs.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: RecurringJob
    listKind: RecurringJobList
    plural: recurringjobs
    shortNames:
    - lhrj
    singular: recurringjob
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              name:
                type: string
              groups:
                type: array
                items:
                  type: string
              task:
                type: string
              cron:
                type: string
              retain:
                type: integer
              concurrency:
                type: integer
              labels:
                type: object
                additionalProperties:
                  type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: Groups
      type: string
      description: Sets groupings to the jobs
      jsonPath: .spec.groups
    - name: Task
      type: string
      description: Should be snapshot or backup
      jsonPath: .spec.task
    - name: Cron
      type: string
      description: The cron expression represents recurring job scheduling
      jsonPath: .spec.cron
    - name: Retain
      type: integer
      description: The number of snapshots/backups to keep for the volume
      jsonPath: .spec.retain
    - name: Concurrency
      type: integer
      description: The concurrent job to run by each cron job
      jsonPath: .spec.concurrency
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp
    - name: Labels
      type: string
      description: Specify the labels
      jsonPath: .spec.labels

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: orphans.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: Orphan
    listKind: OrphanList
    plural: orphans
    shortNames:
    - lho
    singular: orphan
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              nodeID:
                type: string
              type:
                type: string
              parameters:
                type: object
                additionalProperties:
                  type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: snapshots.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: Snapshot
    listKind: SnapshotList
    plural: snapshots
    shortNames:
    - lhsnap
    singular: snapshot
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              volume:
                type: string
              createSnapshot:
                type: boolean
              labels:
                type: object
                additionalProperties:
                  type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: Volume
      type: string
      description: The volume that this snapshot belongs to
      jsonPath: .spec.volume
    - name: CreationTime
      type: string
      description: Timestamp when the snapshot was created
      jsonPath: .status.creationTime
    - name: Size
      type: string
      description: The snapshot size
      jsonPath: .status.size
    - name: ReadyToUse
      type: boolean
      description: Indicates if the snapshot is ready to be used to restore a volume
      jsonPath: .status.readyToUse
    - name: Restoring
      type: boolean
      description: Indicates if the snapshot is being restored
      jsonPath: .status.restoreRequired
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: supportbundles.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: SupportBundle
    listKind: SupportBundleList
    plural: supportbundles
    shortNames:
    - lhbundle
    singular: supportbundle
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              description:
                type: string
              issueURL:
                type: string
              nodeID:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: State
      type: string
      description: The state of the support bundle
      jsonPath: .status.state
    - name: Issue
      type: string
      description: The issue URL
      jsonPath: .spec.issueURL
    - name: Description
      type: string
      description: A brief description of the support bundle
      jsonPath: .spec.description
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: systembackups.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: SystemBackup
    listKind: SystemBackupList
    plural: systembackups
    shortNames:
    - lhsb
    singular: systembackup
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              volumeBackupPolicy:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: Version
      type: string
      description: The system backup Longhorn version
      jsonPath: .status.version
    - name: State
      type: string
      description: The system backup state
      jsonPath: .status.state
    - name: Created
      type: string
      description: The system backup creation time
      jsonPath: .status.createdAt
    - name: LastSyncedAt
      type: string
      description: The last time that the system backup was synced into the cluster
      jsonPath: .status.lastSyncedAt

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: systemrestores.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: SystemRestore
    listKind: SystemRestoreList
    plural: systemrestores
    shortNames:
    - lhsr
    singular: systemrestore
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              systemBackup:
                type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: SystemBackup
      type: string
      description: The system backup name
      jsonPath: .spec.systemBackup
    - name: State
      type: string
      description: The system restore state
      jsonPath: .status.state
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: volumeattachments.longhorn.io
  labels:
    longhorn-manager: ""
spec:
  group: longhorn.io
  names:
    kind: VolumeAttachment
    listKind: VolumeAttachmentList
    plural: volumeattachments
    shortNames:
    - lhva
    singular: volumeattachment
  scope: Namespaced
  versions:
  - name: v1beta2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              volume:
                type: string
              attachmentTickets:
                type: object
                additionalProperties:
                  type: object
                  properties:
                    id:
                      type: string
                    type:
                      type: string
                    nodeID:
                      type: string
                    parameters:
                      type: object
                      additionalProperties:
                        type: string
          status:
            type: object
            x-kubernetes-preserve-unknown-fields: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: Volume
      type: string
      description: The volume that this attachment belongs to
      jsonPath: .spec.volume
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp