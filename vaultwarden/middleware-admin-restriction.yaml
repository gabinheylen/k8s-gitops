apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: admin-ip-restriction
  namespace: vaultwarden
spec:
  ipWhiteList:
    sourceRange:
    - "127.0.0.1/32"           # localhost
    - "10.0.0.0/8"             # Réseau privé classe A
    - "172.16.0.0/12"          # Réseau privé classe B
    - "192.168.0.0/16"         # Réseau privé classe C
    - "82.64.49.250/32"        # IP publique du cluster
    - "2a01:e0a:d2c::/48"      # Votre réseau IPv6 (à adapter)
    - "fc00::/7"               # Réseau privé IPv6
---
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: admin-headers
  namespace: vaultwarden
spec:
  headers:
    customResponseHeaders:
      X-Frame-Options: "DENY"
      X-Content-Type-Options: "nosniff"
      X-XSS-Protection: "1; mode=block"
